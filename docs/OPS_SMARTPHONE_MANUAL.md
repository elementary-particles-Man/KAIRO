<!-- ONE-AIR スマホ運用マニュアル（正式版） -->
# ONE-AIR スマホ運用マニュアル

## 1. 目的
本書は、入国審査支援システム ONE-AIR において、審査官がスマートフォンからセッション UI に安全かつ迅速に接続するための運用手順をまとめたものです。

## 2. 必要なもの
- 審査官用スマートフォン（業務端末）
- ONE-AIR 稼働PC（Windows）
- PC とスマホが **同一ローカルネットワーク** に接続されていること

---

## 3. PC 側起動手順（前提）
1. USBメモリ内の `bin/win/oneair_launcher.bat` を **ダブルクリック** する。
2. 数秒後、PCブラウザが自動で次を開く：
   - `http://127.0.0.1:<ランダムポート>/`
3. ランチャー画面に以下が表示される：
   - ローカルIP（例：`192.168.1.25`）
   - 短縮コード（例：`ab3d`）
   - スマホ接続用URL  
     ※ 実業務UIはランダム生成ポート(50000〜59999)で提供されます。ポート番号はランチャー画面に表示されます。
     - `http://oneair.local:<ランダムポート>/ab3d`
     - `http://192.168.1.25:<ランダムポート>/ab3d`（mDNS不可時の代替）

---

## 4. スマートフォン側アクセス手順
### **基本接続（mDNS 有効時）**
1. スマホのブラウザを開く
2. 次を入力：
```
http://oneair.local:<ランダムポート>/<短縮コード>
```
例：
```
http://oneair.local:<ランダムポート>/ab3d
```
3. 自動的に ONE-AIR スマホ UI にリダイレクトされる。

### **代替接続（mDNS 非対応環境）**
1. ランチャー画面に表示された PC-IP を使用
```
http://<PC-IP>:<ランダムポート>/<短縮コード>
```
例：
```
http://192.168.1.25:<ランダムポート>/ab3d
```

---

## 5. トラブル時のチェック
### ■ 5-1. スマホから接続できない
- 同じ Wi-Fi / LAN に接続されているか確認
- 表示されたランダムポート(50000〜59999)を指定しているか確認
- コード入力ミスがないか確認（英数字4文字）

### ■ 5-2. oneair.local が解決できない
- Android/一部iPhoneでは mDNS が制限される場合があります
- 次の形式に切り替えてください：
```
http://<PC-IP>:<ランダムポート>/<コード>
```

---

## 6. セキュリティ上の注意
- コードは PC 再起動ごとに再生成（セッションごと固有）
- LAN内のみでアクセス可能（外部露出なし）
- URL共有禁止（同一LAN内の第三者に見られる恐れ）

---

## 7. 運用フロー概要
1. PCでランチャー起動 → コード確認
2. スマホからコード付きURLへ接続
3. 審査処理（一次→二次）を実施
4. 終了時はブラウザを閉じるだけで安全に終了

---

## 8. FAQ
**Q. ランチャーが真っ白のまま？**
- PCのファイアウォールで 50000〜59999 番台のアクセスがブロックされている可能性

**Q. URLを入力しても画面が変化しない？**
- コード期限切れ → PC側で再度ランチャーを起動

---

## 9. 連絡先（内部用）
- システム担当：XX室
- 管理責任者：XXX
- 緊急連絡網：XXXX-XXXX

---

以上でスマートフォン運用マニュアルは完了です。
